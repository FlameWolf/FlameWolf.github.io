<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<title>Base-95 Conversion Tool</title>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"/>
		<style>
			:root {
				--bg-color: light-dark(#ffffff, #111827);
				--surface-color: light-dark(#f8fafc, #1f2937);
				--text-color: light-dark(#1f2937, #f9fafb);
				--text-secondary: light-dark(#6b7280, #9ca3af);
				--primary-color: #2563eb;
				--primary-hover: #1d4ed8;
				--error-color: #ef4444;
				--warning-color: #f59e0b;
				--success-color: #10b981;
				--border-color: light-dark(#d1d5db, #374151);
				--border-radius: 0.375rem;
				--box-shadow: 0 0 0.25rem rgba(0, 0, 0, 0.5), 0 0 0.25rem rgba(0, 0, 0, 0.25);
				--box-shadow-lg: 0 0 0.75rem rgba(0, 0, 0, 0.5), 0 0 0.75rem rgba(0, 0, 0, 0.25);
				--transition: all 0.2s ease-in-out;
				color-scheme: light dark;
			}
			@media (prefers-color-scheme: dark) {
				:root {
					--box-shadow: 0 0 0.25rem rgba(255, 255, 255, 0.5), 0 0 0.25rem rgba(255, 255, 255, 0.25);
					--box-shadow-lg: 0 0 0.75rem rgba(255, 255, 255, 0.5), 0 0 0.75rem rgba(255, 255, 255, 0.25);
				}
			}
			* {
				box-sizing: border-box;
			}
			body {
				background-color: var(--bg-color);
				color: var(--text-color);
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
				line-height: 1.6;
				min-width: min-content;
				max-width: 75rem;
				padding: 1rem 1.5rem;
				margin: 0 auto;
			}
			.header {
				text-align: center;
				margin-bottom: 2rem;
				h1 {
					color: var(--primary-color);
					margin: 0 0 0.5rem 0;
				}
				p {
					color: var(--text-secondary);
					margin: 0;
				}
			}
			.tab-container {
				display: flex;
				flex-direction: column;
				background: var(--surface-color);
				border-radius: var(--border-radius);
				overflow: hidden;
				box-shadow: var(--box-shadow);
				> .tab-bar {
					display: flex;
					background: var(--surface-color);
					border-bottom: 1px solid var(--border-color);
					> .tab-btn {
						flex: 1;
						background: transparent;
						color: var(--text-secondary);
						font-weight: 500;
						cursor: pointer;
						padding: 1rem;
						border: none;
						position: relative;
						transition: var(--transition);
						&:hover {
							background: var(--bg-color);
							color: var(--text-color);
						}
						&.active {
							background: var(--bg-color);
							color: var(--primary-color);
							&::after {
								content: "";
								background: var(--primary-color);
								height: 2px;
								position: absolute;
								bottom: 0;
								left: 0;
								right: 0;
							}
						}
					}
				}
				> .tab-panel {
					display: none;
					padding: 2rem;
					&.active {
						display: unset;
					}
				}
			}
			.section {
				margin-bottom: 2rem;
				&:last-child {
					margin-bottom: 0;
				}
			}
			.section-header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 1rem;
			}
			.section-title {
				font-size: 1.125rem;
				font-weight: 600;
				margin: 0;
			}
			.section-actions {
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}
			.btn {
				display: inline-flex;
				align-items: center;
				gap: 0.25rem;
				background: var(--bg-color);
				color: var(--text-color);
				font-size: 0.875rem;
				font-weight: 500;
				cursor: pointer;
				padding: 0.5rem 1rem;
				border: 1px solid var(--border-color);
				border-radius: var(--border-radius);
				transition: var(--transition);
				&:hover:not(:disabled) {
					background: var(--surface-color);
					color: var(--text-secondary);
					border-color: var(--primary-color);
					&:disabled {
						cursor: not-allowed;
						opacity: 0.5;
					}
				}
			}
			.btn-primary {
				background: var(--primary-color);
				color: white;
				border-color: var(--primary-color);
			}
			.btn-success {
				background: var(--success-color);
				color: white;
				border-color: var(--success-color);
			}
			textarea {
				resize: vertical;
				background: var(--bg-color);
				color: var(--text-color);
				font-family: "Monaco", "Menlo", "Ubuntu Mono", monospace;
				font-size: 0.875rem;
				line-height: 1.5;
				width: 100%;
				min-height: 32rem;
				padding: 1rem;
				border: 1px solid var(--border-color);
				border-radius: var(--border-radius);
				transition: var(--transition);
				&:focus {
					border-color: var(--primary-color);
					outline: none;
					box-shadow: 0 0 0 0.25rem rgba(160, 160, 160, 0.5);
				}
				&.drag-over {
					background: rgba(37, 99, 235, 0.05);
					border-color: var(--primary-color);
				}
			}
			.stats {
				display: flex;
				gap: 1rem;
				color: var(--text-secondary);
				font-size: 0.75rem;
				margin-top: 0.5rem;
			}
			.stat {
				display: flex;
				align-items: center;
				gap: 0.25rem;
			}
			.toast {
				color: white;
				font-weight: 500;
				padding: 0.75rem 1rem;
				border-radius: var(--border-radius);
				box-shadow: var(--box-shadow-lg);
				position: fixed;
				top: 1rem;
				right: 1rem;
				opacity: 0;
				transform: translateX(100%);
				transition: var(--transition);
				z-index: 1000;
				&.show {
					opacity: 1;
					transform: translateX(0);
				}
			}
			.toast-success {
				background: var(--success-color);
				color: white;
			}
			.toast-error {
				background: var(--error-color);
				color: white;
			}
			.spinner {
				width: 1rem;
				height: 1rem;
				border: 2px solid transparent;
				border-top: 2px solid currentColor;
				border-radius: 50%;
				animation: spin 1s linear infinite;
			}
			@keyframes spin {
				to {
					transform: rotate(360deg);
				}
			}
			.shortcuts {
				background: var(--surface-color);
				color: var(--text-secondary);
				font-size: 0.75rem;
				padding: 1rem;
				border-radius: var(--border-radius);
				margin-top: 2rem;
				h4 {
					color: var(--text-color);
					margin: 0 0 0.5rem 0;
				}
				ul {
					padding-left: 1.5rem;
					margin: 0;
				}
			}
			.sr-only {
				clip: rect(0, 0, 0, 0);
				white-space: nowrap;
				width: 1px;
				height: 1px;
				padding: 0;
				border: 0;
				overflow: hidden;
				position: absolute;
				margin: -1px;
			}
			@media (max-width: 768px) {
				body {
					padding-inline: 1rem;
				}
				.tab-panel {
					padding: 1rem;
				}
				.section-header {
					flex-direction: column;
					align-items: stretch;
					gap: 1rem;
				}
				.section-actions {
					justify-content: stretch;
					align-items: stretch;
				}
				.btn {
					flex: 1;
					justify-content: center;
				}
			}
		</style>
		<script type="text/javascript" src="JavaScript/gzip.js"></script>
		<script type="text/javascript" src="JavaScript/base-95.js"></script>
		<script>
			"use strict";

			document.addEventListener("DOMContentLoaded", () => {
				const emptyString = "";
				const encoder = new TextEncoder();
				const decoder = new TextDecoder();
				let currentTab = "encode";
				let isProcessing = false;
				function setProcessing(processing, button, text) {
					isProcessing = processing;
					button.disabled = processing;
					if (processing) {
						button.innerHTML = `<span class="spinner"></span> ${text}`;
					} else {
						button.textContent = text;
					}
				}
				function showToast(message, type = "success") {
					const toast = document.createElement("div");
					toast.className = `toast toast-${type}`;
					toast.textContent = message;
					const container = document.getElementById("toast-container");
					container.appendChild(toast);
					setTimeout(() => toast.classList.add("show"), 100);
					setTimeout(() => {
						toast.classList.remove("show");
						setTimeout(() => container.removeChild(toast), 300);
					}, 3000);
				}
				function updateStats() {
					const plainText = document.getElementById("plain-text").value;
					const plainBytes = new Blob([plainText]).size;
					document.getElementById("plain-chars").textContent = `${plainText.length.toLocaleString()} characters`;
					document.getElementById("plain-bytes").textContent = `${plainBytes.toLocaleString()} bytes`;
					const encodedOutput = document.getElementById("encoded-output").value;
					const encodedBytes = new Blob([encodedOutput]).size;
					document.getElementById("encoded-chars").textContent = `${encodedOutput.length.toLocaleString()} characters`;
					document.getElementById("encoded-bytes").textContent = `${encodedBytes.toLocaleString()} bytes`;
					if (plainBytes > 0 && encodedBytes > 0) {
						const ratio = ((plainBytes - encodedBytes) / plainBytes) * 100;
						const ratioText = ratio > 0 ? `${ratio.toFixed(1)}% smaller` : `${Math.abs(ratio).toFixed(1)}% larger`;
						document.getElementById("compression-ratio").textContent = ratioText;
					} else {
						document.getElementById("compression-ratio").textContent = "0% compression";
					}
					const encodedInput = document.getElementById("encoded-input").value;
					document.getElementById("encoded-input-chars").textContent = `${encodedInput.length.toLocaleString()} characters`;
					const decodedOutput = document.getElementById("decoded-output").value;
					const decodedBytes = new Blob([decodedOutput]).size;
					document.getElementById("decoded-chars").textContent = `${decodedOutput.length.toLocaleString()} characters`;
					document.getElementById("decoded-bytes").textContent = `${decodedBytes.toLocaleString()} bytes`;
				}
				async function encodeText(text) {
					if (!text.trim()) {
						return emptyString;
					}
					return encodeBase95(await gzip(encoder.encode(text)));
				}
				async function encode() {
					if (isProcessing) {
						return;
					}
					const input = document.getElementById("plain-text").value;
					const output = document.getElementById("encoded-output");
					const button = document.getElementById("encode-btn");
					if (!input.trim()) {
						showToast("Please enter some text to encode", "error");
						return;
					}
					try {
						setProcessing(true, button, "Encoding...");
						const encoded = await encodeText(input);
						output.value = encoded;
						updateStats();
						showToast("Text encoded successfully!", "success");
					} catch (error) {
						console.error("Encoding failed:", error);
						showToast("Failed to encode text. Please try again.", "error");
					} finally {
						setProcessing(false, button, "Encode");
					}
				}
				function validateBase95Input(input) {
					return input.trim().length > 0;
				}
				async function decodeText(encoded) {
					if (!encoded.trim()) {
						return emptyString;
					}
					return decoder.decode(await gunzip(decodeBase95(encoded)));
				}
				async function decode() {
					if (isProcessing) {
						return;
					}
					const input = document.getElementById("encoded-input").value;
					const output = document.getElementById("decoded-output");
					const button = document.getElementById("decode-btn");
					if (!input.trim()) {
						showToast("Please enter encoded text to decode", "error");
						return;
					}
					if (!validateBase95Input(input)) {
						showToast("Invalid Base-95 encoded text", "error");
						return;
					}
					try {
						setProcessing(true, button, "Decoding...");
						const decoded = await decodeText(input);
						output.value = decoded;
						updateStats();
						showToast("Text decoded successfully!", "success");
					} catch (error) {
						console.error("Decoding failed:", error);
						showToast("Failed to decode text. Please check the input format.", "error");
					} finally {
						setProcessing(false, button, "Decode");
					}
				}
				async function pasteText(targetId) {
					try {
						const text = await navigator.clipboard.readText();
						document.getElementById(targetId).value = text;
						updateStats();
						showToast("Text pasted from clipboard", "success");
					} catch (error) {
						console.error("Failed to paste:", error);
						showToast("Failed to paste from clipboard", "error");
					}
				}
				async function copyText(sourceId) {
					const element = document.getElementById(sourceId);
					if (!element.value.trim()) {
						showToast("Nothing to copy", "error");
						return;
					}
					try {
						await navigator.clipboard.writeText(element.value);
						showToast("Copied to clipboard!", "success");
					} catch (error) {
						console.error("Failed to copy:", error);
						showToast("Failed to copy to clipboard", "error");
					}
				}
				function uploadFile() {
					document.getElementById("file-input").click();
				}
				async function handleFileDrop(file, targetId) {
					if (file.size > 10 * 1024 * 1024) {
						showToast("File too large. Maximum size is 10MB.", "error");
						return;
					}
					try {
						const text = await file.text();
						document.getElementById(targetId).value = text;
						updateStats();
						showToast(`File "${file.name}" loaded successfully`, "success");
					} catch (error) {
						console.error("Failed to read file:", error);
						showToast("Failed to read file", "error");
					}
				}
				async function handleFileSelect(event) {
					const file = event.target.files[0];
					if (file) {
						await handleFileDrop(file, "plain-text");
					}
				}
				function downloadText(sourceId, filename) {
					const element = document.getElementById(sourceId);
					if (!element.value.trim()) {
						showToast("Nothing to download", "error");
						return;
					}
					const blob = new Blob([element.value], { type: "text/plain" });
					const url = URL.createObjectURL(blob);
					const anchor = document.createElement("a");
					anchor.href = url;
					anchor.download = filename;
					document.body.appendChild(anchor);
					anchor.click();
					document.body.removeChild(anchor);
					URL.revokeObjectURL(url);
					showToast("File downloaded successfully", "success");
				}
				async function pasteToCurrentInput() {
					const targetId = currentTab === "encode" ? "plain-text" : "encoded-input";
					await pasteText(targetId);
				}
				async function copyCurrentOutput() {
					const sourceId = currentTab === "encode" ? "encoded-output" : "decoded-output";
					await copyText(sourceId);
				}
				function switchTab(tabName) {
					currentTab = tabName;
					document.querySelectorAll(".tab-btn").forEach(btn => {
						btn.classList.toggle("active", btn.dataset.tab === tabName);
					});
					document.querySelectorAll(".tab-panel").forEach(panel => {
						panel.classList.toggle("active", panel.dataset.panel === tabName);
					});
				}
				function debounce(func, wait) {
					let timeout;
					return function executedFunction(...args) {
						const later = () => {
							clearTimeout(timeout);
							func.apply(this, args);
						};
						clearTimeout(timeout);
						timeout = setTimeout(later, wait);
					};
				}
				document.querySelectorAll(".tab-btn").forEach(btn => {
					btn.addEventListener("click", () => switchTab(btn.dataset.tab));
				});
				document.getElementById("paste-plain").addEventListener("click", () => pasteText("plain-text"));
				document.getElementById("upload-file").addEventListener("click", uploadFile);
				document.getElementById("encode-btn").addEventListener("click", encode);
				document.getElementById("copy-encoded").addEventListener("click", () => copyText("encoded-output"));
				document.getElementById("download-encoded").addEventListener("click", () => downloadText("encoded-output", "encoded.txt"));
				document.getElementById("paste-encoded").addEventListener("click", () => pasteText("encoded-input"));
				document.getElementById("decode-btn").addEventListener("click", decode);
				document.getElementById("copy-decoded").addEventListener("click", () => copyText("decoded-output"));
				document.getElementById("download-decoded").addEventListener("click", () => downloadText("decoded-output", "decoded.txt"));
				document.getElementById("plain-text").addEventListener("input", debounce(updateStats, 300));
				document.getElementById("encoded-input").addEventListener("input", debounce(updateStats, 300));
				document.getElementById("file-input").addEventListener("change", handleFileSelect);
				document.querySelectorAll("textarea:not([readonly])").forEach(textarea => {
					textarea.addEventListener("dragover", e => {
						e.preventDefault();
						textarea.classList.add("drag-over");
					});
					textarea.addEventListener("dragleave", e => {
						e.preventDefault();
						textarea.classList.remove("drag-over");
					});
					textarea.addEventListener("drop", async e => {
						e.preventDefault();
						textarea.classList.remove("drag-over");
						const files = Array.from(e.dataTransfer.files);
						if (files.length > 0) {
							await handleFileDrop(files[0], textarea.id);
						}
					});
				});
				document.addEventListener("keydown", e => {
					if (e.target.tagName === "TEXTAREA" || e.target.tagName === "INPUT") {
						return;
					}
					if (e.ctrlKey || e.metaKey) {
						switch (e.key) {
							case "Enter":
								e.preventDefault();
								currentTab === "encode" ? encode() : decode();
								break;
							case "1":
								e.preventDefault();
								switchTab("encode");
								break;
							case "2":
								e.preventDefault();
								switchTab("decode");
								break;
						}
					} else if (e.altKey) {
						switch (e.key) {
							case "v":
								e.preventDefault();
								pasteToCurrentInput();
								break;
							case "c":
								e.preventDefault();
								copyCurrentOutput();
								break;
						}
					}
				});
				updateStats();
			});
		</script>
	</head>
	<body>
		<header class="header">
			<h1>Base-95 Conversion Tool</h1>
			<p>Encode and decode text using Base-95 conversion with GZip compression</p>
		</header>
		<div class="tab-container">
			<div class="tab-bar">
				<button class="tab-btn active" data-tab="encode">ğŸ“ Encode</button>
				<button class="tab-btn" data-tab="decode">ğŸ”“ Decode</button>
			</div>
			<div class="tab-panel active" data-panel="encode">
				<section class="section">
					<div class="section-header">
						<h3 class="section-title">Plain Text Input</h3>
						<div class="section-actions">
							<button class="btn" id="paste-plain">ğŸ“‹ Paste</button>
							<button class="btn" id="upload-file">ğŸ“ Upload File</button>
							<button class="btn btn-primary" id="encode-btn">ğŸ”’ Encode</button>
						</div>
					</div>
					<textarea id="plain-text" placeholder="Enter or paste your text here, or drag and drop a file..." aria-label="Plain text input for encoding" aria-describedby="plain-text-help"></textarea>
					<div id="plain-text-help" class="sr-only">Enter the text you want to encode using Base-95 compression</div>
					<div class="stats" id="plain-stats">
						<div class="stat">
							<span>ğŸ“</span>
							<span id="plain-chars">0 characters</span>
						</div>
						<div class="stat">
							<span>ğŸ’¾</span>
							<span id="plain-bytes">0 bytes</span>
						</div>
					</div>
				</section>
				<section class="section">
					<div class="section-header">
						<h3 class="section-title">Base-95 Encoded Output</h3>
						<div class="section-actions">
							<button class="btn btn-success" id="copy-encoded">ğŸ“‹ Copy</button>
							<button class="btn" id="download-encoded">ğŸ’¾ Download</button>
						</div>
					</div>
					<textarea id="encoded-output" readonly placeholder="Encoded text will appear here..." aria-label="Base-95 encoded output"></textarea>
					<div class="stats" id="encoded-stats">
						<div class="stat">
							<span>ğŸ“</span>
							<span id="encoded-chars">0 characters</span>
						</div>
						<div class="stat">
							<span>ğŸ’¾</span>
							<span id="encoded-bytes">0 bytes</span>
						</div>
						<div class="stat">
							<span>ğŸ“Š</span>
							<span id="compression-ratio">0% compression</span>
						</div>
					</div>
				</section>
			</div>
			<div class="tab-panel" data-panel="decode">
				<section class="section">
					<div class="section-header">
						<h3 class="section-title">Base-95 Encoded Input</h3>
						<div class="section-actions">
							<button class="btn" id="paste-encoded">ğŸ“‹ Paste</button>
							<button class="btn btn-primary" id="decode-btn">ğŸ”“ Decode</button>
						</div>
					</div>
					<textarea id="encoded-input" placeholder="Paste your Base-95 encoded text here..." aria-label="Base-95 encoded input for decoding" aria-describedby="encoded-input-help"></textarea>
					<div id="encoded-input-help" class="sr-only">Enter the Base-95 encoded text you want to decode</div>
					<div class="stats" id="encoded-input-stats">
						<div class="stat">
							<span>ğŸ“</span>
							<span id="encoded-input-chars">0 characters</span>
						</div>
					</div>
				</section>
				<section class="section">
					<div class="section-header">
						<h3 class="section-title">Decoded Plain Text</h3>
						<div class="section-actions">
							<button class="btn btn-success" id="copy-decoded">ğŸ“‹ Copy</button>
							<button class="btn" id="download-decoded">ğŸ’¾ Download</button>
						</div>
					</div>
					<textarea id="decoded-output" readonly placeholder="Decoded text will appear here..." aria-label="Decoded plain text output"></textarea>
					<div class="stats" id="decoded-stats">
						<div class="stat">
							<span>ğŸ“</span>
							<span id="decoded-chars">0 characters</span>
						</div>
						<div class="stat">
							<span>ğŸ’¾</span>
							<span id="decoded-bytes">0 bytes</span>
						</div>
					</div>
				</section>
			</div>
		</div>
		<div class="shortcuts">
			<h4>âŒ¨ï¸ Keyboard Shortcuts</h4>
			<ul>
				<li><kbd>Ctrl/Cmd + Enter</kbd> - Process current tab (encode/decode)</li>
				<li><kbd>Alt + V</kbd> - Paste into current input</li>
				<li><kbd>Alt + C</kbd> - Copy current output</li>
				<li><kbd>Ctrl/Cmd + 1/2</kbd> - Switch between tabs</li>
			</ul>
		</div>
		<input type="file" id="file-input" style="display: none" accept=".txt,.md,.json,.xml,.csv"/>
		<div id="toast-container"></div>
	</body>
</html>